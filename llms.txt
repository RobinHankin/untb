# The unified neutral theory of biodiversity: the untb package

![](reference/figures/untb.png)

The `untb` package provides R-centric functionality for working with
Hubbell’s unified neutral theory of biogeography and biodiversity. A
vignette is provided in the package. The canonical reference is Hubbell
2001; to cite the package in publications please use Hankin 2007.

# Installation

You can install the released version of the `untb` package from
[CRAN](https://CRAN.R-project.org) with:

``` r
# install.packages("untb")  # uncomment this to install the package
library("untb")
set.seed(0)
```

# The `untb` package in use

The package has two main classes, `count` and `census`. A `count` object
is a named integer vector, with names being species and entries being
respective counts. Thus:

``` r
x <- count(c(cats=9,pigs=3,dogs=2,rats=1,hogs=1,bats=1))
x
#> cats pigs dogs rats hogs bats 
#>    9    3    2    1    1    1
summary(x)
#> Number of individuals: 17 
#> Number of species: 6 
#> Number of singletons: 3 
#> Most abundant species: cats (9 individuals)
#> estimated theta:  2.861392
```

Above, we see 9 cats, 3 pigs, and so on. Function
[`summary()`](https://rdrr.io/r/base/summary.html) gives further
information. A `census` object is an unordered factor with entries being
the species of each individual:

``` r
as.census(x)
#>  [1] cats cats cats cats cats cats cats cats cats pigs pigs pigs dogs dogs rats
#> [16] hogs bats
#> Levels: cats pigs dogs rats hogs bats
```

The package includes example datasets:

``` r
data(sahfos)
summary(sahfos)
#> Number of individuals: 460182 
#> Number of species: 54 
#> Number of singletons: 10 
#> Most abundant species: Echinodermata larvae (247200 individuals)
#> estimated theta:  4.649568
```

We can give a visual summary of a dataset in two ways:

``` r
plot(sahfos)
```

![](reference/figures/README-prestonplotsahfos-1.png)

``` r
plot(preston(sahfos))
```

![](reference/figures/README-prestonplotsahfos-2.png)

The package also includes the ability to generate random neutral
assemblages:

``` r
summary(rand.neutral(1000,10))
#> Number of individuals: 1000 
#> Number of species: 47 
#> Number of singletons: 8 
#> Most abundant species: 2 (330 individuals)
#> estimated theta:  10.09543
summary(rand.neutral(1000,10))
#> Number of individuals: 1000 
#> Number of species: 52 
#> Number of singletons: 16 
#> Most abundant species: 4 (117 individuals)
#> estimated theta:  11.50422
```

## References

- S. P. Hubbell 2001. “The Unified Neutral Theory of Biodiversity and
  Biogeography”, Princeton University Press.

- R. K. S. Hankin, 2007. “Introducing untb, an R package for simulating
  ecological drift under the unified nuetral theory of biodiversity”,
  *Journal of Statistical Software* 22(12)

# Package index

## All functions

- [`alonso.eqn6()`](https://robinhankin.github.io/untb/reference/alonso.md)
  [`alonso.eqn11()`](https://robinhankin.github.io/untb/reference/alonso.md)
  [`alonso.eqn12()`](https://robinhankin.github.io/untb/reference/alonso.md)
  : Various functions from Alonso and McKane 2004
- [`bci`](https://robinhankin.github.io/untb/reference/bci.md)
  [`BCI`](https://robinhankin.github.io/untb/reference/bci.md) : Barro
  Colorado Island (BCI) dataset
- [`butterflies`](https://robinhankin.github.io/untb/reference/butterflies.md)
  : abundance data for butterflies
- [`caruso`](https://robinhankin.github.io/untb/reference/caruso.md) :
  Dataset due to Caruso
- [`census()`](https://robinhankin.github.io/untb/reference/census.md)
  [`as.census()`](https://robinhankin.github.io/untb/reference/census.md)
  [`is.census()`](https://robinhankin.github.io/untb/reference/census.md)
  : Construct, coerce, and test for a census object
- [`copepod`](https://robinhankin.github.io/untb/reference/copepod.md)
  [`ostracod`](https://robinhankin.github.io/untb/reference/copepod.md)
  : Copepod data supplied by Phil Pugh
- [`as.count()`](https://robinhankin.github.io/untb/reference/count.md)
  [`count()`](https://robinhankin.github.io/untb/reference/count.md)
  [`is.count()`](https://robinhankin.github.io/untb/reference/count.md)
  : Construct, coerce, and test for a count object
- [`display.untb()`](https://robinhankin.github.io/untb/reference/display.untb.md)
  : Animation of neutral ecological drift
- [`etienne()`](https://robinhankin.github.io/untb/reference/etienne.md)
  [`optimal.params()`](https://robinhankin.github.io/untb/reference/etienne.md)
  : Etienne's sampling formula
- [`expected.abundance()`](https://robinhankin.github.io/untb/reference/expected.abundance.md)
  : Expected abundances under the neutral model
- [`extractor()`](https://robinhankin.github.io/untb/reference/extractor.md)
  : Extract rows of a database in count form
- [`fishers.alpha()`](https://robinhankin.github.io/untb/reference/fisher.md)
  [`fisher.ecosystem()`](https://robinhankin.github.io/untb/reference/fisher.md)
  : Various functionality to implement Fisher's logseries
- [`ghats`](https://robinhankin.github.io/untb/reference/ghats.md) :
  Tree counts in 1-ha plots from the Western Ghats mountains (South
  India)
- [`isolate()`](https://robinhankin.github.io/untb/reference/isolate.md)
  : Randomly select a subset of an ecosystem
- [`logS1`](https://robinhankin.github.io/untb/reference/logS1.md) :
  logarithms of Stirling numbers of the first kind
- [`logkda.R()`](https://robinhankin.github.io/untb/reference/logkda.md)
  [`logkda.a11()`](https://robinhankin.github.io/untb/reference/logkda.md)
  [`logkda.pari()`](https://robinhankin.github.io/untb/reference/logkda.md)
  [`logkda.polyn()`](https://robinhankin.github.io/untb/reference/logkda.md)
  [`logkda()`](https://robinhankin.github.io/untb/reference/logkda.md)
  [`logkda_pari_unix()`](https://robinhankin.github.io/untb/reference/logkda.md)
  [`logkda_pari_windows()`](https://robinhankin.github.io/untb/reference/logkda.md)
  : Etienne's K(D,A)
- [`no.of.ind()`](https://robinhankin.github.io/untb/reference/no.of.ind.md)
  [`no.of.spp()`](https://robinhankin.github.io/untb/reference/no.of.ind.md)
  [`no.of.singletons()`](https://robinhankin.github.io/untb/reference/no.of.ind.md)
  [`no.of.extinct()`](https://robinhankin.github.io/untb/reference/no.of.ind.md)
  [`maximal.abundance()`](https://robinhankin.github.io/untb/reference/no.of.ind.md)
  [`singletons()`](https://robinhankin.github.io/untb/reference/no.of.ind.md)
  [`extinct()`](https://robinhankin.github.io/untb/reference/no.of.ind.md)
  [`extant()`](https://robinhankin.github.io/untb/reference/no.of.ind.md)
  : Ecosystem diagnostics
- [`optimal.params.gst()`](https://robinhankin.github.io/untb/reference/optimal.params.gst.md)
  [`GST.k()`](https://robinhankin.github.io/untb/reference/optimal.params.gst.md)
  [`I.k()`](https://robinhankin.github.io/untb/reference/optimal.params.gst.md)
  : Estimation of local immigration using GST(k) statistics
- [`optimal.params.sloss()`](https://robinhankin.github.io/untb/reference/optimal.params.sloss.md)
  : Estimation of neutral community parameters using a two-stage
  maximum-likelihood procedure
- [`optimal.prob()`](https://robinhankin.github.io/untb/reference/optimal.prob.md)
  [`optimal.theta()`](https://robinhankin.github.io/untb/reference/optimal.prob.md)
  : Returns an estimate of the fundamental biodiversity number
- [`phi()`](https://robinhankin.github.io/untb/reference/phi.md)
  [`unphi()`](https://robinhankin.github.io/untb/reference/phi.md) :
  Hubbell's phi
- [`plot(`*`<count>`*`)`](https://robinhankin.github.io/untb/reference/plot.count.md)
  [`plot(`*`<census>`*`)`](https://robinhankin.github.io/untb/reference/plot.count.md)
  : Abundance curves
- [`` `+`( ``*`<count>`*`)`](https://robinhankin.github.io/untb/reference/plus.md)
  [`` `+`( ``*`<census>`*`)`](https://robinhankin.github.io/untb/reference/plus.md)
  : Add two count objects
- [`preston()`](https://robinhankin.github.io/untb/reference/preston.md)
  : Preston diagram of an ecosystem
- [`print(`*`<preston>`*`)`](https://robinhankin.github.io/untb/reference/print.preston.md)
  [`plot(`*`<preston>`*`)`](https://robinhankin.github.io/untb/reference/print.preston.md)
  : Print and plot objects of class Preston
- [`print(`*`<summary.count>`*`)`](https://robinhankin.github.io/untb/reference/print.summary.count.md)
  : Print method for summary objects
- [`rand.neutral()`](https://robinhankin.github.io/untb/reference/rand.neutral.md)
  : Random neutral ecosystem
- [`sahfos`](https://robinhankin.github.io/untb/reference/sahfos.md) :
  Biodiversity dataset provided by SAHFOS
- [`saunders`](https://robinhankin.github.io/untb/reference/saunders.md)
  : Dataset due to Saunders
- [`simpson()`](https://robinhankin.github.io/untb/reference/simpson.md)
  : Simpson's diversity index
- [`species.count()`](https://robinhankin.github.io/untb/reference/species.count.md)
  [`species.table()`](https://robinhankin.github.io/untb/reference/species.count.md)
  : Ecosystem diagnostics for output of untb()
- [`spitale`](https://robinhankin.github.io/untb/reference/spitale.md) :
  Counts of diatom species in springs of the Adamello-Brenta Nature Park
- [`summary(`*`<count>`*`)`](https://robinhankin.github.io/untb/reference/summary.md)
  [`summary(`*`<census>`*`)`](https://robinhankin.github.io/untb/reference/summary.md)
  : Summary methods for count and census objects
- [`theta.prob()`](https://robinhankin.github.io/untb/reference/theta.prob.md)
  [`theta.likelihood()`](https://robinhankin.github.io/untb/reference/theta.prob.md)
  : Posterior probabilities for theta
- [`untb()`](https://robinhankin.github.io/untb/reference/untb.md)
  [`select()`](https://robinhankin.github.io/untb/reference/untb.md)
  [`select.mutate()`](https://robinhankin.github.io/untb/reference/untb.md)
  [`select.immigrate()`](https://robinhankin.github.io/untb/reference/untb.md)
  : Ecological drift simulation under the Unified Neutral Theory of
  Biodiversity
- [`untb-package`](https://robinhankin.github.io/untb/reference/untb.package.md)
  : Unified neutral theory of biodiversity
- [`vallade.eqn5()`](https://robinhankin.github.io/untb/reference/vallade.md)
  [`vallade.eqn7()`](https://robinhankin.github.io/untb/reference/vallade.md)
  [`vallade.eqn12()`](https://robinhankin.github.io/untb/reference/vallade.md)
  [`vallade.eqn14()`](https://robinhankin.github.io/untb/reference/vallade.md)
  [`vallade.eqn16()`](https://robinhankin.github.io/untb/reference/vallade.md)
  [`vallade.eqn17()`](https://robinhankin.github.io/untb/reference/vallade.md)
  : Various functions from Vallade and Houchmandzadeh
- [`volkov()`](https://robinhankin.github.io/untb/reference/volkov.md) :
  Expected frequency of species
- [`zsm()`](https://robinhankin.github.io/untb/reference/zsm.md) : Zero
  sum multinomial distribution as derived by McKane

